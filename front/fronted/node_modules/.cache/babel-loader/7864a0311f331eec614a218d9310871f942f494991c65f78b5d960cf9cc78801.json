{"ast":null,"code":"var _jsxFileName = \"E:\\\\proyeco final web 2\\\\front\\\\fronted\\\\src\\\\pages\\\\PublicHome.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport MapView from '../components/MapView/MapView';\nimport RoadsList from '../components/RoadsList';\nimport { fetchRoads, fetchMunicipalities, fetchIncidents } from '../services/api';\nimport { Button, Modal, Form } from 'react-bootstrap';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction PublicHome() {\n  _s();\n  const [roads, setRoads] = useState([]);\n  const [municipalities, setMunicipalities] = useState([]);\n  const [incidents, setIncidents] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [selectedRoadId, setSelectedRoadId] = useState(null);\n\n  // Modal para reportar incidente\n  const [showReportModal, setShowReportModal] = useState(false);\n  const [reportDetail, setReportDetail] = useState('');\n  const [reportImage, setReportImage] = useState(null);\n  const [reportCoords, setReportCoords] = useState({\n    lat: -16.5,\n    lng: -63.0\n  }); // Ejemplo\n\n  useEffect(() => {\n    loadData();\n  }, []);\n  async function loadData() {\n    setLoading(true);\n    setError(null);\n    try {\n      const r = await fetchRoads();\n      const m = await fetchMunicipalities();\n      const i = await fetchIncidents();\n      setRoads(r);\n      setMunicipalities(m);\n      setIncidents(i);\n    } catch (err) {\n      console.error(err);\n      setError('Error al cargar datos');\n    } finally {\n      setLoading(false);\n    }\n  }\n  const handleViewRoad = roadId => {\n    setSelectedRoadId(roadId);\n  };\n  const handleSubmitReport = async e => {\n    e.preventDefault();\n    try {\n      const {\n        createIncidentRequest\n      } = await import('../services/api');\n      await createIncidentRequest(reportDetail, reportImage, reportCoords);\n      alert('Solicitud enviada con éxito');\n      setShowReportModal(false);\n      setReportDetail('');\n      setReportImage(null);\n    } catch (err) {\n      console.error(err);\n      alert('Error al enviar solicitud');\n    }\n  };\n  if (loading) return /*#__PURE__*/_jsxDEV(\"p\", {\n    children: \"Cargando...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 63,\n    columnNumber: 23\n  }, this);\n  if (error) return /*#__PURE__*/_jsxDEV(\"p\", {\n    children: error\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 64,\n    columnNumber: 21\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Sistema de Consulta de Transporte en Carreteras\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Button, {\n      variant: \"success\",\n      className: \"mb-3\",\n      onClick: () => setShowReportModal(true),\n      children: \"Reportar incidente\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(MapView, {\n      roads: roads,\n      municipalities: municipalities,\n      incidents: incidents,\n      selectedRoadId: selectedRoadId\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(RoadsList, {\n      roads: roads,\n      onViewRoad: handleViewRoad\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      show: showReportModal,\n      onHide: () => setShowReportModal(false),\n      children: [/*#__PURE__*/_jsxDEV(Modal.Header, {\n        closeButton: true,\n        children: /*#__PURE__*/_jsxDEV(Modal.Title, {\n          children: \"Reportar Incidente\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Modal.Body, {\n        children: /*#__PURE__*/_jsxDEV(Form, {\n          onSubmit: handleSubmitReport,\n          children: [/*#__PURE__*/_jsxDEV(Form.Group, {\n            className: \"mb-3\",\n            controlId: \"incidentDetail\",\n            children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n              children: \"Detalle\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 86,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n              as: \"textarea\",\n              rows: 3,\n              value: reportDetail,\n              onChange: e => setReportDetail(e.target.value),\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 87,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n            className: \"mb-3\",\n            children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n              children: \"Foto del incidente\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 90,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n              type: \"file\",\n              onChange: e => setReportImage(e.target.files[0])\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 91,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 89,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"primary\",\n            type: \"submit\",\n            children: \"Enviar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 94,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 67,\n    columnNumber: 5\n  }, this);\n}\n_s(PublicHome, \"+3nhB4tO+5a3OCmWHql2lZVJk6k=\");\n_c = PublicHome;\nexport default PublicHome;\nvar _c;\n$RefreshReg$(_c, \"PublicHome\");","map":{"version":3,"names":["React","useEffect","useState","MapView","RoadsList","fetchRoads","fetchMunicipalities","fetchIncidents","Button","Modal","Form","jsxDEV","_jsxDEV","PublicHome","_s","roads","setRoads","municipalities","setMunicipalities","incidents","setIncidents","loading","setLoading","error","setError","selectedRoadId","setSelectedRoadId","showReportModal","setShowReportModal","reportDetail","setReportDetail","reportImage","setReportImage","reportCoords","setReportCoords","lat","lng","loadData","r","m","i","err","console","handleViewRoad","roadId","handleSubmitReport","e","preventDefault","createIncidentRequest","alert","children","fileName","_jsxFileName","lineNumber","columnNumber","variant","className","onClick","onViewRoad","show","onHide","Header","closeButton","Title","Body","onSubmit","Group","controlId","Label","Control","as","rows","value","onChange","target","required","type","files","_c","$RefreshReg$"],"sources":["E:/proyeco final web 2/front/fronted/src/pages/PublicHome.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport MapView from '../components/MapView/MapView';\r\nimport RoadsList from '../components/RoadsList';\r\nimport { fetchRoads, fetchMunicipalities, fetchIncidents } from '../services/api';\r\nimport { Button, Modal, Form } from 'react-bootstrap';\r\n\r\nfunction PublicHome() {\r\n  const [roads, setRoads] = useState([]);\r\n  const [municipalities, setMunicipalities] = useState([]);\r\n  const [incidents, setIncidents] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  \r\n  const [selectedRoadId, setSelectedRoadId] = useState(null);\r\n\r\n  // Modal para reportar incidente\r\n  const [showReportModal, setShowReportModal] = useState(false);\r\n  const [reportDetail, setReportDetail] = useState('');\r\n  const [reportImage, setReportImage] = useState(null);\r\n  const [reportCoords, setReportCoords] = useState({ lat: -16.5, lng: -63.0 }); // Ejemplo\r\n\r\n  useEffect(() => {\r\n    loadData();\r\n  }, []);\r\n\r\n  async function loadData() {\r\n    setLoading(true);\r\n    setError(null);\r\n    try {\r\n      const r = await fetchRoads();\r\n      const m = await fetchMunicipalities();\r\n      const i = await fetchIncidents();\r\n      setRoads(r);\r\n      setMunicipalities(m);\r\n      setIncidents(i);\r\n    } catch (err) {\r\n      console.error(err);\r\n      setError('Error al cargar datos');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  const handleViewRoad = (roadId) => {\r\n    setSelectedRoadId(roadId);\r\n  };\r\n\r\n  const handleSubmitReport = async (e) => {\r\n    e.preventDefault();\r\n    try {\r\n      const { createIncidentRequest } = await import('../services/api');\r\n      await createIncidentRequest(reportDetail, reportImage, reportCoords);\r\n      alert('Solicitud enviada con éxito');\r\n      setShowReportModal(false);\r\n      setReportDetail('');\r\n      setReportImage(null);\r\n    } catch (err) {\r\n      console.error(err);\r\n      alert('Error al enviar solicitud');\r\n    }\r\n  };\r\n\r\n  if (loading) return <p>Cargando...</p>;\r\n  if (error) return <p>{error}</p>;\r\n\r\n  return (\r\n    <div>\r\n      <h1>Sistema de Consulta de Transporte en Carreteras</h1>\r\n      <Button variant=\"success\" className=\"mb-3\" onClick={()=>setShowReportModal(true)}>Reportar incidente</Button>\r\n      <MapView \r\n        roads={roads} \r\n        municipalities={municipalities} \r\n        incidents={incidents} \r\n        selectedRoadId={selectedRoadId}\r\n      />\r\n      <RoadsList roads={roads} onViewRoad={handleViewRoad} />\r\n\r\n      {/* Modal Reportar Incidente */}\r\n      <Modal show={showReportModal} onHide={()=>setShowReportModal(false)}>\r\n        <Modal.Header closeButton>\r\n          <Modal.Title>Reportar Incidente</Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body>\r\n          <Form onSubmit={handleSubmitReport}>\r\n            <Form.Group className=\"mb-3\" controlId=\"incidentDetail\">\r\n              <Form.Label>Detalle</Form.Label>\r\n              <Form.Control as=\"textarea\" rows={3} value={reportDetail} onChange={e=>setReportDetail(e.target.value)} required />\r\n            </Form.Group>\r\n            <Form.Group className=\"mb-3\">\r\n              <Form.Label>Foto del incidente</Form.Label>\r\n              <Form.Control type=\"file\" onChange={e=>setReportImage(e.target.files[0])} />\r\n            </Form.Group>\r\n            {/* Podrías agregar un picker de coordenadas en el mapa para el reporte */}\r\n            <Button variant=\"primary\" type=\"submit\">Enviar</Button>\r\n          </Form>\r\n        </Modal.Body>\r\n      </Modal>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default PublicHome;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}